
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>BaseAlgo - SequeL</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sequel.algos.base_algo" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SequeL" class="md-header__button md-logo" aria-label="SequeL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SequeL
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              BaseAlgo
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nik-dim/sequel" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github.com/nik-dim/sequel
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Algorithms
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../benchmarks/base_benchmark/" class="md-tabs__link">
        Benchmarks
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../backbones/pytorch/base/" class="md-tabs__link">
        Backbones
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../utils/callbacks/base_callback/" class="md-tabs__link">
        Utilities
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SequeL" class="md-nav__button md-logo" aria-label="SequeL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    SequeL
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nik-dim/sequel" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github.com/nik-dim/sequel
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../..">Home</a>
          
            <label for="__nav_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Installation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reproducibility/" class="md-nav__link">
        Reproducibility
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        How to get Started
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Algorithms
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Algorithms" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Algorithms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          BaseAlgo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        BaseAlgo
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sequel.algos.base_algo" class="md-nav__link">
    sequel.algos.base_algo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm" class="md-nav__link">
    BaseAlgorithm
  </a>
  
    <nav class="md-nav" aria-label="BaseAlgorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.check_and_parse_callbacks" class="md-nav__link">
    check_and_parse_callbacks()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.eval_epoch" class="md-nav__link">
    eval_epoch()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.parse_benchmark" class="md-nav__link">
    parse_benchmark()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.test_step" class="md-nav__link">
    test_step()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.train_algorithm_on_task" class="md-nav__link">
    train_algorithm_on_task()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.training_epoch" class="md-nav__link">
    training_epoch()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.training_step" class="md-nav__link">
    training_step()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.unpack_batch" class="md-nav__link">
    unpack_batch()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.update_episodic_memory" class="md-nav__link">
    update_episodic_memory()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.valid_step" class="md-nav__link">
    valid_step()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2">
          PyTorch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="PyTorch" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          PyTorch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/base_algo/" class="md-nav__link">
        PyTorchBaseAlgo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/agem/" class="md-nav__link">
        AGEM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/der/" class="md-nav__link">
        DER
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/er/" class="md-nav__link">
        ER
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/ewc/" class="md-nav__link">
        EWC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/icarl/" class="md-nav__link">
        iCaRL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/joint/" class="md-nav__link">
        Joint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/kcl/" class="md-nav__link">
        KCL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/lamaml/" class="md-nav__link">
        LaMAML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/lfl/" class="md-nav__link">
        LFL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/mas/" class="md-nav__link">
        MAS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/mcsgd/" class="md-nav__link">
        MC-SGD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/si/" class="md-nav__link">
        SI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_3">
          JAX
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="JAX" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          JAX
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/base_algo/" class="md-nav__link">
        JaxBaseAlgo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/agem/" class="md-nav__link">
        AGEM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/der/" class="md-nav__link">
        DER
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/er/" class="md-nav__link">
        ER
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/ewc/" class="md-nav__link">
        EWC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/icarl/" class="md-nav__link">
        iCaRL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/joint/" class="md-nav__link">
        Joint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/lfl/" class="md-nav__link">
        LFL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/mas/" class="md-nav__link">
        MAS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/mcsgd/" class="md-nav__link">
        MC-SGD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jax/si/" class="md-nav__link">
        SI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_4">
          Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Utilities" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/state_manager/" class="md-nav__link">
        state_manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/callback_hooks/" class="md-nav__link">
        callback_hooks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Benchmarks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Benchmarks" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Benchmarks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/base_benchmark/" class="md-nav__link">
        base_benchmark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/memory/" class="md-nav__link">
        memory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/mnist/" class="md-nav__link">
        MNIST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/cifar/" class="md-nav__link">
        CIFAR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/tinyimagenet/" class="md-nav__link">
        TinyImageNet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/utils/" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Backbones
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Backbones" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Backbones
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1">
          PyTorch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="PyTorch" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          PyTorch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backbones/pytorch/base/" class="md-nav__link">
        Base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backbones/pytorch/mlp/" class="md-nav__link">
        MLP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backbones/pytorch/cnn/" class="md-nav__link">
        CNN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backbones/pytorch/resnet/" class="md-nav__link">
        ResNet
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2">
          JAX
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="JAX" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          JAX
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backbones/jax/base/" class="md-nav__link">
        Base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backbones/jax/mlp/" class="md-nav__link">
        MLP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backbones/jax/cnn/" class="md-nav__link">
        CNN
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Utilities" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1" type="checkbox" id="__nav_5_1" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_1">
          Callbacks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Callbacks" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          Callbacks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/callbacks/base_callback/" class="md-nav__link">
        BaseCallback
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/callbacks/metric_callback/" class="md-nav__link">
        MetricCallback
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/callbacks/pytorch_metric_callback/" class="md-nav__link">
        PytorchMetricCallback
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/callbacks/jax_metric_callback/" class="md-nav__link">
        JaxMetricCallback
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/callbacks/input_visualization_callback/" class="md-nav__link">
        InputVisualizationCallback
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/callbacks/memory_callback/" class="md-nav__link">
        MemoryCallback
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_2">
          Loggers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Loggers" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Loggers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/loggers/base_logger/" class="md-nav__link">
        BaseLogger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/loggers/comet_logger/" class="md-nav__link">
        CometLogger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/loggers/console_logger/" class="md-nav__link">
        ConsoleLogger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/loggers/tensorboard_logger/" class="md-nav__link">
        TensorBoardLogger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/loggers/wandb_logger/" class="md-nav__link">
        WandbLogger
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sequel.algos.base_algo" class="md-nav__link">
    sequel.algos.base_algo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm" class="md-nav__link">
    BaseAlgorithm
  </a>
  
    <nav class="md-nav" aria-label="BaseAlgorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.check_and_parse_callbacks" class="md-nav__link">
    check_and_parse_callbacks()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.eval_epoch" class="md-nav__link">
    eval_epoch()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.parse_benchmark" class="md-nav__link">
    parse_benchmark()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.test_step" class="md-nav__link">
    test_step()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.train_algorithm_on_task" class="md-nav__link">
    train_algorithm_on_task()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.training_epoch" class="md-nav__link">
    training_epoch()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.training_step" class="md-nav__link">
    training_step()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.unpack_batch" class="md-nav__link">
    unpack_batch()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.update_episodic_memory" class="md-nav__link">
    update_episodic_memory()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequel.algos.base_algo.BaseAlgorithm.valid_step" class="md-nav__link">
    valid_step()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/nik-dim/sequel/edit/master/docs/algos/base_algo.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>BaseAlgo</h1>

<div class="doc doc-object doc-module">


<a id="sequel.algos.base_algo"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="sequel.algos.base_algo.BaseAlgorithm" class="doc doc-heading">
        <code>BaseAlgorithm</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="sequel.algos.utils.BaseStateManager">BaseStateManager</span></code>, <code><a class="autorefs autorefs-internal" title="sequel.algos.utils.BaseCallbackHook" href="../utils/callback_hooks/#sequel.algos.utils.callback_hooks.BaseCallbackHook">BaseCallbackHook</a></code>, <code><a class="autorefs autorefs-internal" title="sequel.utils.callbacks.base_callback.BaseCallback" href="../../utils/callbacks/base_callback/#sequel.utils.callbacks.base_callback.BaseCallback">BaseCallback</a></code></p>

  
      <p>Base class for Trainer component. Handles all the engineering code. Connects the algorighm with callback and
logging functionallities. The class also inherits from BaseCallback and the user can implement desired
functionalities either as standalone callbacks or by overwriting the parent callback hooks of the algorithm.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>metric_callback_msg</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>A message set by the MetricCallback that informs about the progress of
training/validation etc. Can be used by other callbacks, e.g., TqdmCallback, to display such information
in the console.</p></td>
        </tr>
        <tr>
          <td><code>num_tasks</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>number of tasks. Set by <a class="autorefs autorefs-internal" href="#sequel.algos.base_algo.BaseAlgorithm.parse_benchmark"><code>parse_benchmark</code></a>.</p></td>
        </tr>
        <tr>
          <td><code>classes_per_task</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>the number of classes per task. For the moment, all tasks should have the same number
of classes. Set by <a class="autorefs autorefs-internal" href="#sequel.algos.base_algo.BaseAlgorithm.parse_benchmark"><code>parse_benchmark</code></a>.</p></td>
        </tr>
        <tr>
          <td><code>episodic_memory_loader</code></td>
          <td>
                <code>torch.<span title="torch.utils">utils</span>.<span title="torch.utils.data">data</span>.<span title="torch.utils.data.DataLoader">DataLoader</span></code>
          </td>
          <td><p>The dataloader for the memory. Applies to methods that
utilize memoreis, such as GEM.</p></td>
        </tr>
        <tr>
          <td><code>episodic_memory_iter</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[torch.<span title="torch.utils">utils</span>.<span title="torch.utils.data">data</span>.<span title="torch.utils.data.DataLoader">DataLoader</span>]</code>
          </td>
          <td><p>An iterator for <code>episodic_memory_loader</code></p></td>
        </tr>
        <tr>
          <td><code>loss</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[torch.<span title="torch.Tensor">Tensor</span>, numpy.<span title="numpy.array">array</span>]</code>
          </td>
          <td><p>The loss of the current batch.</p></td>
        </tr>
        <tr>
          <td><code>current_dataloader</code></td>
          <td>
                <code>torch.<span title="torch.utils">utils</span>.<span title="torch.utils.data">data</span>.<span title="torch.utils.data.DataLoader">DataLoader</span></code>
          </td>
          <td><p>The current training/validation/testing dataloader.</p></td>
        </tr>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[torch.<span title="torch.Tensor">Tensor</span>, numpy.<span title="numpy.array">array</span>]</code>
          </td>
          <td><p>The input tensors of the current batch. Set by
<a class="autorefs autorefs-internal" href="#sequel.algos.base_algo.BaseAlgorithm.unpack_batch"><code>unpack_batch</code></a>.</p></td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[torch.<span title="torch.Tensor">Tensor</span>, numpy.<span title="numpy.array">array</span>]</code>
          </td>
          <td><p>The targets of the current batch. Set by
<a class="autorefs autorefs-internal" href="#sequel.algos.base_algo.BaseAlgorithm.unpack_batch"><code>unpack_batch</code></a>.</p></td>
        </tr>
        <tr>
          <td><code>t</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[torch.<span title="torch.Tensor">Tensor</span>, numpy.<span title="numpy.array">array</span>]</code>
          </td>
          <td><p>The task ids of the current batch. Set by
<a class="autorefs autorefs-internal" href="#sequel.algos.base_algo.BaseAlgorithm.unpack_batch"><code>unpack_batch</code></a>.</p></td>
        </tr>
        <tr>
          <td><code>bs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The size of the current batch. Set by <a class="autorefs autorefs-internal" href="#sequel.algos.base_algo.BaseAlgorithm.unpack_batch"><code>unpack_batch</code></a>.</p></td>
        </tr>
        <tr>
          <td><code>epochs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The epochs each task is trained for.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BaseAlgorithm</span><span class="p">(</span><span class="n">BaseStateManager</span><span class="p">,</span> <span class="n">BaseCallbackHook</span><span class="p">,</span> <span class="n">BaseCallback</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for Trainer component. Handles all the engineering code. Connects the algorighm with callback and</span>
<span class="sd">    logging functionallities. The class also inherits from BaseCallback and the user can implement desired</span>
<span class="sd">    functionalities either as standalone callbacks or by overwriting the parent callback hooks of the algorithm.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        metric_callback_msg (Optional[str]): A message set by the MetricCallback that informs about the progress of</span>
<span class="sd">            training/validation etc. Can be used by other callbacks, e.g., TqdmCallback, to display such information</span>
<span class="sd">            in the console.</span>
<span class="sd">        num_tasks (int): number of tasks. Set by [`parse_benchmark`][sequel.algos.base_algo.BaseAlgorithm.parse_benchmark].</span>
<span class="sd">        classes_per_task (int): the number of classes per task. For the moment, all tasks should have the same number</span>
<span class="sd">            of classes. Set by [`parse_benchmark`][sequel.algos.base_algo.BaseAlgorithm.parse_benchmark].</span>
<span class="sd">        episodic_memory_loader (torch.utils.data.DataLoader): The dataloader for the memory. Applies to methods that</span>
<span class="sd">            utilize memoreis, such as GEM.</span>
<span class="sd">        episodic_memory_iter (Iterable[torch.utils.data.DataLoader]): An iterator for `episodic_memory_loader`</span>
<span class="sd">        loss (Union[torch.Tensor, numpy.array]): The loss of the current batch.</span>
<span class="sd">        current_dataloader (torch.utils.data.DataLoader): The current training/validation/testing dataloader.</span>
<span class="sd">        x (Union[torch.Tensor, numpy.array]): The input tensors of the current batch. Set by</span>
<span class="sd">            [`unpack_batch`][sequel.algos.base_algo.BaseAlgorithm.unpack_batch].</span>
<span class="sd">        y (Union[torch.Tensor, numpy.array]): The targets of the current batch. Set by</span>
<span class="sd">            [`unpack_batch`][sequel.algos.base_algo.BaseAlgorithm.unpack_batch].</span>
<span class="sd">        t (Union[torch.Tensor, numpy.array]): The task ids of the current batch. Set by</span>
<span class="sd">            [`unpack_batch`][sequel.algos.base_algo.BaseAlgorithm.unpack_batch].</span>
<span class="sd">        bs (int): The size of the current batch. Set by [`unpack_batch`][sequel.algos.base_algo.BaseAlgorithm.unpack_batch].</span>
<span class="sd">        epochs (int): The epochs each task is trained for.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">metric_callback_msg</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">episodic_memory_loader</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">episodic_memory_iter</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">backbone</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PytorchBaseBackbone</span><span class="p">,</span> <span class="n">JaxBaseBackbone</span><span class="p">],</span>
        <span class="n">benchmark</span><span class="p">:</span> <span class="n">Benchmark</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">,</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformation</span><span class="p">],</span>
        <span class="n">callbacks</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">BaseCallback</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">loggers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Logger</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">lr_decay</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">grad_clip</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">reinit_optimizer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Inits the BaseAlgorithm class. Handles all the engineering code. Base classes for algorithms in Pytorch and</span>
<span class="sd">        Jax inherit from this class.</span>

<span class="sd">        Args:</span>
<span class="sd">            backbone (Union[PytorchBaseBackbone, JaxBaseBackbone]): The backbone model, e.g., a CNN.</span>
<span class="sd">            benchmark (Benchmark): The benchmark, e.g., SplitMNIST.</span>
<span class="sd">            optimizer (Union[torch.optim.Optimizer, optax.GradientTransformation]): The optimizer used to update the</span>
<span class="sd">                backbone weights.</span>
<span class="sd">            callbacks (Iterable[BaseCallback], optional): A list of callbacks. At least one instance of MetricCallback</span>
<span class="sd">                should be given. Defaults to [].</span>
<span class="sd">            loggers (Optional[Logger], optional): A list of logger, e.g. for Weights&amp;Biases logging functionality.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            lr_decay (Optional[float], optional): A learning rate decay used for every new task. Defaults to None.</span>
<span class="sd">            reinit_optimizer (bool): Indicates whether the optimizer state is reinitialized before fitting a new task.</span>
<span class="sd">                Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">install_logging</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">benchmark</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_benchmark</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span> <span class="o">=</span> <span class="n">backbone</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_and_parse_callbacks</span><span class="p">(</span><span class="n">callbacks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loggers</span> <span class="o">=</span> <span class="n">loggers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lr_decay</span> <span class="o">=</span> <span class="n">lr_decay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reinit_optimizer</span> <span class="o">=</span> <span class="n">reinit_optimizer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad_clip</span> <span class="o">=</span> <span class="n">grad_clip</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_clip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gradient clipping has been set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grad_clip</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The backbone model has </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">count_parameters</span><span class="p">()</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">m parameters&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_and_parse_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">BaseCallback</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">BaseCallback</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Checks that the callbacks is a list containing exaclty one MetricCallback.</span>

<span class="sd">        Args:</span>
<span class="sd">            callbacks (Iterable[BaseCallback]): list of callbacks</span>

<span class="sd">        Returns:</span>
<span class="sd">            Iterable[BaseCallback]: the parsed list of callbacks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sequel.utils.callbacks.metrics.metric_callback</span> <span class="kn">import</span> <span class="n">MetricCallback</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callbacks</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s2">&quot;The callbacks should be given as a list.&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="nb">sum</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">MetricCallback</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="p">),</span> <span class="s2">&quot;Exactly one instance of MetricCallback should be given.&quot;</span>

        <span class="c1"># make sure that the MetricCallback is last.</span>
        <span class="n">parsed_callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">callbacks</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">MetricCallback</span><span class="p">)]</span>
        <span class="n">parsed_callbacks</span> <span class="o">+=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">callbacks</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">MetricCallback</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">parsed_callbacks</span>

    <span class="k">def</span> <span class="nf">parse_benchmark</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extracts attributes from the benchmark and registers them to the algo for quick access.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">num_tasks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes_per_task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">classes_per_task</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_dimensions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">dimensions</span>

    <span class="k">def</span> <span class="nf">update_episodic_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Updates the episodic memory. This funciton is called after fitting one task.&quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating episodic memory for task </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_counter</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">episodic_memory_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">memory_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_counter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">episodic_memory_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">episodic_memory_loader</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sample_batch_from_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">episodic_memory_iter</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="c1"># makes the dataloader an infinite stream</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">episodic_memory_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">episodic_memory_loader</span><span class="p">)</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">episodic_memory_iter</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">batch</span>

    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="c1"># logger: Logger</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loggers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">logger</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loggers</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">step_counter</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">epoch_counter</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">log_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loggers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">logger</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loggers</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">log_figure</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">figure</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">count_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">:</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_configure_criterion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calls the forward function of the model.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">update_tqdm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_callback_msg</span> <span class="o">=</span> <span class="n">msg</span>
        <span class="c1"># self.tqdm_dl.set_postfix(msg)</span>

    <span class="k">def</span> <span class="nf">unpack_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unpacks the batch and registers to the algorithm the current batch input, targets and task ids as `self.x`,</span>
<span class="sd">        `self.y` and `self.t`, respectively. It also registers the current batch size as `self.bs`&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">optimizer_zero_grad</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">backpropagate_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">optimizer_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">perform_gradient_clipping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The training step, i.e. training for each batch.</span>

<span class="sd">        Goes through the usual hoops of zeroing out the optimizer, forwarding the input, computing the loss,</span>
<span class="sd">        backpropagating and updating the weights. For each different steps, callabacks are offered for maximum</span>
<span class="sd">        versatility and ease of use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_zero_grad</span><span class="p">()</span>
        <span class="n">y_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_loss</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_backward</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_backward_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backpropagate_loss</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_backward</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_backward_callbacks</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">perform_gradient_clipping</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_optimizer_step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_optimizer_step_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_optimizer_step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_optimizer_step_callbacks</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">valid_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Performs the validation step.Callbacks are offered for each step of the process.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Performs the testing step. Callbacks are offered for each step of the process.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">training_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Trains the model for a single epoch. Callbacks are offered for each method.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="s2">&quot;epoch&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_training_mode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span>
        <span class="k">for</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_idx</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_dataloader</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unpack_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_before_training_step</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_before_training_step_callbacks</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">training_step</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_after_training_step</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_after_training_step_callbacks</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">eval_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Performs the evaluation of the model on the validation set. If no validation dataloader is provided, the</span>
<span class="sd">        method returns without any computation.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_loader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_evaluation_mode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_loader</span>

        <span class="k">for</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_idx</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_dataloader</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unpack_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_before_val_step</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_before_val_step_callbacks</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valid_step</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_after_val_step</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_after_val_step_callbacks</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">prepare_for_next_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">prepare_train_loader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">train_algorithm_on_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fits a *single* task.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_train_loader</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_for_next_task</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_epochs</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">listconfig</span><span class="o">.</span><span class="n">ListConfig</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_epochs</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epochs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">task_counter</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epochs</span>

        <span class="k">for</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_task_epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_train_loop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_val_loop</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_train_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_training_epoch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_training_epoch_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">training_epoch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_training_epoch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_training_epoch_callbacks</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_val_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># after each epoch, the model is validated on current and previous tasks.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_validating_algorithm_on_all_tasks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_validating_algorithm_on_all_tasks_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_algorithm_on_all_tasks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_validating_algorithm_on_all_tasks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_validating_algorithm_on_all_tasks_callbacks</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">validate_algorithm_on_all_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_counter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_val_task</span> <span class="o">=</span> <span class="n">task</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valid_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">val_dataloader</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">on_before_val_epoch</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_before_val_epoch_callbacks</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eval_epoch</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_after_val_epoch</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_after_val_epoch_callbacks</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fits all tasks to the model, one after the other.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_tasks</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_before_training_task</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_before_training_task_callbacks</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="s2">&quot;task&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_algorithm_on_task</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_after_training_task</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_after_training_task_callbacks</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_run_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_setup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_setup_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_setup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_setup_callbacks</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_run_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_fit_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_fit_callbacks</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_run_teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_teardown</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_teardown_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">teardown</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_teardown</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_teardown_callbacks</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epochs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_epochs</span> <span class="o">=</span> <span class="n">epochs</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_run_setup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_teardown</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">compute_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">task_ids</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">backbone</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[],</span> <span class="n">loggers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lr_decay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grad_clip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reinit_optimizer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Inits the BaseAlgorithm class. Handles all the engineering code. Base classes for algorithms in Pytorch and
Jax inherit from this class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>backbone</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="sequel.backbones.pytorch.BaseBackbone" href="../../backbones/pytorch/base/#sequel.backbones.pytorch.base_backbone.BaseBackbone">PytorchBaseBackbone</a>, <a class="autorefs autorefs-internal" title="sequel.backbones.jax.BaseBackbone" href="../../backbones/jax/base/#sequel.backbones.jax.base_backbone.BaseBackbone">JaxBaseBackbone</a>]</code>
          </td>
          <td><p>The backbone model, e.g., a CNN.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benchmark</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="sequel.benchmarks.Benchmark" href="../../benchmarks/base_benchmark/#sequel.benchmarks.base_benchmark.Benchmark">Benchmark</a></code>
          </td>
          <td><p>The benchmark, e.g., SplitMNIST.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>optimizer</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[torch.<span title="torch.optim">optim</span>.<span title="torch.optim.Optimizer">Optimizer</span>, optax.<span title="optax.GradientTransformation">GradientTransformation</span>]</code>
          </td>
          <td><p>The optimizer used to update the
backbone weights.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>callbacks</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="sequel.utils.callbacks.base_callback.BaseCallback" href="../../utils/callbacks/base_callback/#sequel.utils.callbacks.base_callback.BaseCallback">BaseCallback</a>]</code>
          </td>
          <td><p>A list of callbacks. At least one instance of MetricCallback
should be given. Defaults to [].</p></td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>loggers</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="sequel.utils.loggers.Logger" href="../../utils/loggers/base_logger/#sequel.utils.loggers.base_logger.Logger">Logger</a>]</code>
          </td>
          <td><p>A list of logger, e.g. for Weights&amp;Biases logging functionality.
Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>lr_decay</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td><p>A learning rate decay used for every new task. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>reinit_optimizer</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Indicates whether the optimizer state is reinitialized before fitting a new task.
Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">backbone</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PytorchBaseBackbone</span><span class="p">,</span> <span class="n">JaxBaseBackbone</span><span class="p">],</span>
    <span class="n">benchmark</span><span class="p">:</span> <span class="n">Benchmark</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">,</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformation</span><span class="p">],</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">BaseCallback</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">loggers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Logger</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lr_decay</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">grad_clip</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">reinit_optimizer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Inits the BaseAlgorithm class. Handles all the engineering code. Base classes for algorithms in Pytorch and</span>
<span class="sd">    Jax inherit from this class.</span>

<span class="sd">    Args:</span>
<span class="sd">        backbone (Union[PytorchBaseBackbone, JaxBaseBackbone]): The backbone model, e.g., a CNN.</span>
<span class="sd">        benchmark (Benchmark): The benchmark, e.g., SplitMNIST.</span>
<span class="sd">        optimizer (Union[torch.optim.Optimizer, optax.GradientTransformation]): The optimizer used to update the</span>
<span class="sd">            backbone weights.</span>
<span class="sd">        callbacks (Iterable[BaseCallback], optional): A list of callbacks. At least one instance of MetricCallback</span>
<span class="sd">            should be given. Defaults to [].</span>
<span class="sd">        loggers (Optional[Logger], optional): A list of logger, e.g. for Weights&amp;Biases logging functionality.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        lr_decay (Optional[float], optional): A learning rate decay used for every new task. Defaults to None.</span>
<span class="sd">        reinit_optimizer (bool): Indicates whether the optimizer state is reinitialized before fitting a new task.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">install_logging</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">benchmark</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parse_benchmark</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span> <span class="o">=</span> <span class="n">backbone</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_and_parse_callbacks</span><span class="p">(</span><span class="n">callbacks</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loggers</span> <span class="o">=</span> <span class="n">loggers</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">lr_decay</span> <span class="o">=</span> <span class="n">lr_decay</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reinit_optimizer</span> <span class="o">=</span> <span class="n">reinit_optimizer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grad_clip</span> <span class="o">=</span> <span class="n">grad_clip</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_clip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gradient clipping has been set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grad_clip</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The backbone model has </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">count_parameters</span><span class="p">()</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">m parameters&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.check_and_parse_callbacks" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_and_parse_callbacks</span><span class="p">(</span><span class="n">callbacks</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Checks that the callbacks is a list containing exaclty one MetricCallback.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>callbacks</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="sequel.utils.callbacks.base_callback.BaseCallback" href="../../utils/callbacks/base_callback/#sequel.utils.callbacks.base_callback.BaseCallback">BaseCallback</a>]</code>
          </td>
          <td><p>list of callbacks</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="sequel.utils.callbacks.base_callback.BaseCallback" href="../../utils/callbacks/base_callback/#sequel.utils.callbacks.base_callback.BaseCallback">BaseCallback</a>]</code>
          </td>
          <td><p>Iterable[BaseCallback]: the parsed list of callbacks.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_and_parse_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">BaseCallback</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">BaseCallback</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Checks that the callbacks is a list containing exaclty one MetricCallback.</span>

<span class="sd">    Args:</span>
<span class="sd">        callbacks (Iterable[BaseCallback]): list of callbacks</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable[BaseCallback]: the parsed list of callbacks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sequel.utils.callbacks.metrics.metric_callback</span> <span class="kn">import</span> <span class="n">MetricCallback</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callbacks</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s2">&quot;The callbacks should be given as a list.&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="nb">sum</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">MetricCallback</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="p">),</span> <span class="s2">&quot;Exactly one instance of MetricCallback should be given.&quot;</span>

    <span class="c1"># make sure that the MetricCallback is last.</span>
    <span class="n">parsed_callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">callbacks</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">MetricCallback</span><span class="p">)]</span>
    <span class="n">parsed_callbacks</span> <span class="o">+=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">callbacks</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">MetricCallback</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">parsed_callbacks</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.eval_epoch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_epoch</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Performs the evaluation of the model on the validation set. If no validation dataloader is provided, the
method returns without any computation.</p>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eval_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the evaluation of the model on the validation set. If no validation dataloader is provided, the</span>
<span class="sd">    method returns without any computation.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_loader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_evaluation_mode</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_loader</span>

    <span class="k">for</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_idx</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_dataloader</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unpack_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_val_step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_val_step_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valid_step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_val_step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_val_step_callbacks</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.forward" class="doc doc-heading">
<code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Calls the forward function of the model.</p>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calls the forward function of the model.&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.parse_benchmark" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse_benchmark</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extracts attributes from the benchmark and registers them to the algo for quick access.</p>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_benchmark</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extracts attributes from the benchmark and registers them to the algo for quick access.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">num_tasks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">classes_per_task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">classes_per_task</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_dimensions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">dimensions</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.test_step" class="doc doc-heading">
<code class="highlight language-python"><span class="n">test_step</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Performs the testing step. Callbacks are offered for each step of the process.</p>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the testing step. Callbacks are offered for each step of the process.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.train_algorithm_on_task" class="doc doc-heading">
<code class="highlight language-python"><span class="n">train_algorithm_on_task</span><span class="p">(</span><span class="n">task</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Fits a <em>single</em> task.</p>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">train_algorithm_on_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fits a *single* task.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_train_loader</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prepare_for_next_task</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_epochs</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">listconfig</span><span class="o">.</span><span class="n">ListConfig</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_epochs</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epochs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">task_counter</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epochs</span>

    <span class="k">for</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_task_epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_train_loop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_val_loop</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.training_epoch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">training_epoch</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Trains the model for a single epoch. Callbacks are offered for each method.</p>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">training_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Trains the model for a single epoch. Callbacks are offered for each method.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="s2">&quot;epoch&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_training_mode</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_loader</span>
    <span class="k">for</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_idx</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_dataloader</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unpack_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_training_step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_before_training_step_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">training_step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_training_step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_after_training_step_callbacks</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.training_step" class="doc doc-heading">
<code class="highlight language-python"><span class="n">training_step</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The training step, i.e. training for each batch.</p>
<p>Goes through the usual hoops of zeroing out the optimizer, forwarding the input, computing the loss,
backpropagating and updating the weights. For each different steps, callabacks are offered for maximum
versatility and ease of use.</p>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The training step, i.e. training for each batch.</span>

<span class="sd">    Goes through the usual hoops of zeroing out the optimizer, forwarding the input, computing the loss,</span>
<span class="sd">    backpropagating and updating the weights. For each different steps, callabacks are offered for maximum</span>
<span class="sd">    versatility and ease of use.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_zero_grad</span><span class="p">()</span>
    <span class="n">y_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_loss</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">on_before_backward</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_before_backward_callbacks</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">backpropagate_loss</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_after_backward</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_after_backward_callbacks</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">perform_gradient_clipping</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">on_before_optimizer_step</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_before_optimizer_step_callbacks</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_step</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_after_optimizer_step</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_after_optimizer_step_callbacks</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.unpack_batch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unpack_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Unpacks the batch and registers to the algorithm the current batch input, targets and task ids as <code>self.x</code>,
<code>self.y</code> and <code>self.t</code>, respectively. It also registers the current batch size as <code>self.bs</code></p>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unpack_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unpacks the batch and registers to the algorithm the current batch input, targets and task ids as `self.x`,</span>
<span class="sd">    `self.y` and `self.t`, respectively. It also registers the current batch size as `self.bs`&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.update_episodic_memory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_episodic_memory</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Updates the episodic memory. This funciton is called after fitting one task.</p>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_episodic_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Updates the episodic memory. This funciton is called after fitting one task.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating episodic memory for task </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_counter</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">episodic_memory_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">memory_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_counter</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">episodic_memory_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">episodic_memory_loader</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="sequel.algos.base_algo.BaseAlgorithm.valid_step" class="doc doc-heading">
<code class="highlight language-python"><span class="n">valid_step</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Performs the validation step.Callbacks are offered for each step of the process.</p>

      <details class="quote">
        <summary>Source code in <code>sequel/algos/base_algo.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">valid_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the validation step.Callbacks are offered for each step of the process.&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../examples/" class="md-footer__link md-footer__link--prev" aria-label="Previous: How to get Started" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              How to get Started
            </div>
          </div>
        </a>
      
      
        
        <a href="../pytorch/base_algo/" class="md-footer__link md-footer__link--next" aria-label="Next: PyTorchBaseAlgo" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              PyTorchBaseAlgo
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.sections", "git-authors"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
  </body>
</html>